




<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation">
      
      
        <meta name="author" content="Percona LLC">
      
      
        <link rel="canonical" href="https://docs.percona.com/percona-operator-for-postgresql/update.html">
      
      
        <link rel="prev" href="backups.html">
      
      
        <link rel="next" href="scaling.html">
      
      
      <link rel="icon" href="assets/operators-fav.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Upgrade Percona Distribution for PostgreSQL and the Operator - Percona Operator for PostgreSQL</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unicons.iconscout.com/release/v3.0.3/css/line.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
    
      <link rel="stylesheet" href="css/lightgallery.min.css">
    
      <link rel="stylesheet" href="css/nocopy.css">
    
      <link rel="stylesheet" href="css/extra.css">
    
      <link rel="stylesheet" href="css/design.css">
    
      <link rel="stylesheet" href="css/operators.css">
    
      <link rel="stylesheet" href="css/osano.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
               
                 
                 
                 
                 
                 <meta property="og:type" content="website" />
                 <meta property="og:title" content="Percona Operator for PostgreSQL - Upgrade Percona Distribution for PostgreSQL and the Operator" />
                 <meta property="og:image" content="https://docs.percona.com/percona-operator-for-postgresql/assets/images/kubernetes-operators.png">
                 <meta property="og:url" content="https://docs.percona.com/percona-operator-for-postgresql/">
                </head>
                <body>
                </body>
              </html>

              
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#update-percona-operator-for-postgresql" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine classes -->


  


<!-- Header -->
<header class="md-header md-header--shadow" data-md-component="header">

  <!-- Super Nav -->
  <div class="superNav">
    <div class="md-header__inner md-grid">
      <a href="https://pmcf-percona.github.io/docs-home/percona-operators/" title="Percona Documentation home page">
        <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <mask id="a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24">
            <path d="M0 0h24v24H0z"/>
          </mask>
          <g mask="url(#a)">
            <path d="m7.825 13 5.6 5.6L12 20l-8-8 8-8 1.425 1.4-5.6 5.6H20v2H7.825Z"/>
          </g>
        </svg>
        <span>Percona Documentation</span>
      </a>
    </div>
  </div>

  <nav
    class="md-header__inner md-grid"
    aria-label="Header"
  >

    <!-- Link to home -->
    <a
      href="index.html"
      title="Percona Operator for PostgreSQL"
      class="md-header__button md-logo"
      aria-label="Percona Operator for PostgreSQL"
      data-md-component="logo"
    >
      
  <img src="assets/operators-mark.svg" alt="logo">

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title">
      <div class="md-header__ellipsis">
        <a href="index.html" class="md-header__topic">
          <span class="md-ellipsis">
            Percona Operator for PostgreSQL
          </span>
        </a>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Upgrade Percona Distribution for PostgreSQL and the Operator
            
          </span>
        </div>
      </div>
    </div>

    <!-- Color palette toggle -->
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Color theme set to Automatic. Click to change"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Color theme set to Automatic. Click to change" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Color theme set to Light Mode. Click to change"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Color theme set to Light Mode. Click to change" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Color theme set to Dark Mode. Click to change"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Color theme set to Dark Mode. Click to change" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    

    <!-- User preference: color palette -->
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>

      <!-- Search interface -->
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository information -->
    
      <div class="md-header__source">
        <a href="https://github.com/percona/k8spg-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    percona/k8spg-docs
  </div>
</a>
      </div>
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Percona Operator for PostgreSQL" class="md-nav__button md-logo" aria-label="Percona Operator for PostgreSQL" data-md-component="logo">
      
  <img src="assets/operators-mark.svg" alt="logo">

    </a>
    Percona Operator for PostgreSQL
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/percona/k8spg-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    percona/k8spg-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Requirements
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Requirements
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="System-Requirements.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System Requirements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="architecture.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Design and architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="compare.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comparison with other solutions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Quickstart guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Quickstart guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="minikube.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install on Minikube
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="helm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install with Helm
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Installation guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Installation guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gke.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install on Google Kubernetes Engine (GKE)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="kubernetes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generic Kubernetes installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="openshift.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install on OpenShift
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="users.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Application and system users
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="options.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changing PostgreSQL Options
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="constraints.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Anti-affinity and tolerations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TLS.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transport Encryption (TLS/SSL)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="telemetry.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Telemetry
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Management
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="backups.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backup and restore
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Upgrade Percona Distribution for PostgreSQL and the Operator
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="update.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Upgrade Percona Distribution for PostgreSQL and the Operator
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#upgrading-the-operator" class="md-nav__link">
    <span class="md-ellipsis">
      Upgrading the Operator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrading-percona-distribution-for-postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      Upgrading Percona Distribution for PostgreSQL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Upgrading Percona Distribution for PostgreSQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-upgrade" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic upgrade
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semi-automatic-upgrade" class="md-nav__link">
    <span class="md-ellipsis">
      Semi-automatic upgrade
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-expert-help" class="md-nav__link">
    <span class="md-ellipsis">
      Get expert help
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="scaling.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Horizontal and vertical scaling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="monitoring.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitor with Percona Monitoring and Management (PMM)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="pause.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restart or pause the cluster
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    How to
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            How to
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="standby.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deploy a standby cluster for Disaster Recovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cluster-wide.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Provide Percona Operator for PostgreSQL single-namespace and multi-namespace deployment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tablespace.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Use PostgreSQL tablespaces with Percona Operator for PostgreSQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="private.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating a private S3-compatible cloud for backups
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="operator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Resource options
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="installation-options.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operator installation options
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="images.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Percona certified images
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="faq.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Frequently Asked Questions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.percona.com/legacy-documentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Old releases (documentation archive)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="copyright.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Copyright and licensing information
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="trademark-policy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trademark policy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Release Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Release Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ReleaseNotes/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release notes index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ReleaseNotes/Kubernetes-Operator-for-PostgreSQL-RN1.5.1.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Percona Operator for PostgreSQL 1.5.1 (2024-01-29)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ReleaseNotes/Kubernetes-Operator-for-PostgreSQL-RN1.5.0.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Percona Operator for PostgreSQL 1.5.0 (2023-12-11)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ReleaseNotes/Kubernetes-Operator-for-PostgreSQL-RN1.4.0.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Percona Operator for PostgreSQL 1.4.0 (2023-03-31)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ReleaseNotes/Kubernetes-Operator-for-PostgreSQL-RN1.3.0.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Percona Operator for PostgreSQL 1.3.0 (2022-08-04)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ReleaseNotes/Kubernetes-Operator-for-PostgreSQL-RN1.2.0.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Percona Operator for PostgreSQL 1.2.0 (2022-04-06)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ReleaseNotes/Kubernetes-Operator-for-PostgreSQL-RN1.1.0.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Percona Operator for PostgreSQL 1.1.0 (2021-12-07)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ReleaseNotes/Kubernetes-Operator-for-PostgreSQL-RN1.0.0.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Percona Operator for PostgreSQL 1.0.0 (2021-10-07)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ReleaseNotes/Kubernetes-Operator-for-PostgreSQL-RN0.2.0.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Percona Operator for PostgreSQL 0.2.0 (2021-08-12)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ReleaseNotes/Kubernetes-Operator-for-PostgreSQL-RN0.1.0.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Percona Operator for PostgreSQL 0.1.0 (2021-05-10)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.percona.com/k8s" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Join K8S Squad
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                    <br>
                    <label class="md-nav__title" for="__drawer">

  </label> 
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#upgrading-the-operator" class="md-nav__link">
    <span class="md-ellipsis">
      Upgrading the Operator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrading-percona-distribution-for-postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      Upgrading Percona Distribution for PostgreSQL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Upgrading Percona Distribution for PostgreSQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-upgrade" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic upgrade
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semi-automatic-upgrade" class="md-nav__link">
    <span class="md-ellipsis">
      Semi-automatic upgrade
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-expert-help" class="md-nav__link">
    <span class="md-ellipsis">
      Get expert help
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/percona/k8spg-docs/edit/main/docs/update.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/percona/k8spg-docs/raw/main/docs/update.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="update-percona-operator-for-postgresql">Update Percona Operator for PostgreSQL<a class="headerlink" href="#update-percona-operator-for-postgresql" title="Permanent link">&para;</a></h1>
<p>Percona Operator for PostgreSQL allows upgrades to newer versions.
This includes upgrades of the Operator itself, and upgrades of the Percona
Distribution for PostgreSQL.</p>
<h2 id="upgrading-the-operator">Upgrading the Operator<a class="headerlink" href="#upgrading-the-operator" title="Permanent link">&para;</a></h2>
<p>Only the incremental update to a nearest minor version of the Operator 1.x is
supported. To update to a newer version, which differs from the current
version by more than one, make several incremental updates sequentially.
See <a href="https://docs.percona.com/legacy-documentation/">documentation archive</a>
for documentation on previous versions of the Operator.</p>
<p>You can check the Operator images to find out the current Operator version with
the following command (in case it is deployed in the <code>pgo</code> namespace):</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>deployment<span class="w"> </span>postgres-operator<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>percona-postgresql-operator
</code></pre></div>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>image: percona/percona-postgresql-operator:1.4.0-pgo-apiserver
image: percona/percona-postgresql-operator:1.4.0-postgres-operator
image: percona/percona-postgresql-operator:1.4.0-pgo-scheduler
image: percona/percona-postgresql-operator:1.4.0-pgo-event
</code></pre></div>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above command and other commands in this section follow the assumption
that the context with the Operator namespace (<code>pgo</code> by default) was set.
You can set context as follows:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>config<span class="w"> </span>set-context<span class="w"> </span><span class="k">$(</span>kubectl<span class="w"> </span>config<span class="w"> </span>current-context<span class="k">)</span><span class="w"> </span>--namespace<span class="o">=</span>pgo
</code></pre></div>
<p>Alternatively, you can specify the proper namespace explicitly: for example,
by adding the <code>-n pgo</code> option to <code>kubectl</code> in all commands.</p>
</div>
<p>The following steps will update the Operator to a newer version:</p>
<ol>
<li>
<p>Check that the Operator deployment job is not still present in your cluster:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>job/pgo-deploy<span class="w"> </span>-n<span class="w"> </span>pgo
</code></pre></div>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>NAME         COMPLETIONS   DURATION   AGE
pgo-deploy   1/1           81s        5m53s
</code></pre></div>
</details>
<p>If the job is not present, you will get a message that it is not found.
Otherwise you should delete this job before upgrading the Operator:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>delete<span class="w">  </span>job/pgo-deploy<span class="w"> </span>-n<span class="w"> </span>pgo
</code></pre></div>
</li>
<li>
<p>Upgrading the Operator is similar to deploying a new Operator version, but
    you should change the <code>DEPLOY_ACTION</code> option in the <code>deploy/operator.yaml</code>
    file before applying it from <code>install</code> to <code>update</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pgo-deploy</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">percona/percona-postgresql-operator:1.4.0-pgo-deployer</span>
<span class="w">      </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<span class="hll"><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEPLOY_ACTION</span>
</span><span class="hll"><span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">update</span>
</span><span class="nn">...</span>
</code></pre></div>
<p>You can automate this with the <a href="https://github.com/mikefarah/yq/#install">yq tool</a>
as follows, assuming that you are upgrading to the Operator version {{ release }}:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>curl<span class="w"> </span>-s<span class="w"> </span>https://raw.githubusercontent.com/percona/percona-postgresql-operator/v<span class="o">{{</span><span class="w"> </span>release<span class="w"> </span><span class="o">}}</span>/deploy/operator.yaml<span class="w"> </span><span class="p">|</span><span class="w"> </span>yq<span class="w"> </span>w<span class="w"> </span>--doc<span class="w"> </span><span class="m">4</span><span class="w"> </span>-<span class="w"> </span><span class="s2">&quot;spec.template.spec.containers[0].env[0].value&quot;</span><span class="w"> </span><span class="s2">&quot;update&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-
$<span class="w"> </span>kubectl<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>--for<span class="o">=</span><span class="nv">condition</span><span class="o">=</span>Complete<span class="w"> </span>job/pgo-deploy<span class="w"> </span>--timeout<span class="o">=</span>90s
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The example above (and other examples in this document) uses <a href="https://github.com/mikefarah/yq/releases/tag/3.4.0">the yq version 3.4.0</a>. Note that the syntax for the <code>yq</code> command may be slightly different in other versions.</p>
</div>
<p>Applying the modified <code>operator.yaml</code> will produce the command output as
follows:</p>
<div class="no-copy highlight"><pre><span></span><code>serviceaccount/pgo-deployer-sa unchanged
clusterrole.rbac.authorization.k8s.io/pgo-deployer-cr unchanged
configmap/pgo-deployer-cm configured
clusterrolebinding.rbac.authorization.k8s.io/pgo-deployer-crb unchanged
job.batch/pgo-deploy created
</code></pre></div>
</li>
<li>
<p>The <code>pgo-deploy</code> Kubernetes Job created to carry on the Operator deployment
    process can take a minute or more to be completed. You can track it with the
    following command:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>job/pgo-deploy
</code></pre></div>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>NAME         COMPLETIONS   DURATION   AGE
pgo-deploy   1/1           81s        5m53s
</code></pre></div>
</details>
<p>When it reaches the COMPLETIONS count of <code>1/1</code>, you can safely delete the
job as follows:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>delete<span class="w">  </span>job/pgo-deploy
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Deleting the <code>pgo-deploy</code> job will be needed before the next upgrade of
the Operator.</p>
</div>
</li>
</ol>
<h2 id="upgrading-percona-distribution-for-postgresql">Upgrading Percona Distribution for PostgreSQL<a class="headerlink" href="#upgrading-percona-distribution-for-postgresql" title="Permanent link">&para;</a></h2>
<h3 id="automatic-upgrade">Automatic upgrade<a class="headerlink" href="#automatic-upgrade" title="Permanent link">&para;</a></h3>
<p>Starting from version 1.1.0, the Operator does fully automatic upgrades to
the newer versions of Percona PostgreSQL Cluster within the method named <em>Smart
Updates</em>.</p>
<p>The Operator will carry on upgrades according to the following algorithm.
It will query a special <em>Version Service</em> server at scheduled times to obtain
fresh information about version numbers and valid image paths needed for the
upgrade. If the current version should be upgraded, the Operator updates the CR
to reflect the new image paths and carries on sequential Pods deletion in a safe
order, allowing the cluster Pods to be re-deployed with the new image.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Version Service is in technical preview status and is disabled by
default for the Operator version 1.1.0. Disabling Version Service
makes Smart Updates rely on the <code>image</code> keys in the <a href="operator.html#operator-custom-resource-options">Operators Custom Resource</a>.</p>
</div>
<p>The upgrade details are set in the <code>upgradeOptions</code> section of the
<code>deploy/cr.yaml</code> configuration file. Make the following edits to configure
updates:</p>
<ol>
<li>
<p>Set the <code>apply</code> option to one of the following values:</p>
<ul>
<li><code>recommended</code> - automatic upgrades will choose the most recent version
    of software flagged as recommended (for clusters created from scratch,
    the Percona Distribution for PostgreSQL 14 version will be selected
    instead of the Percona Distribution for PostgreSQL 13 or 12 version
    regardless of the image path; for already existing clusters, 14 vs. 13 or
    12 branch choice will be preserved),</li>
<li><code>14-recommended</code>, <code>13-recommended</code>, <code>12-recommended</code> - same as above,
    but preserves specific major Percona Distribution for PostgreSQL version
    for newly provisioned clusters (for example, 14 will not be automatically
    used instead of 13),</li>
<li><code>latest</code> - automatic upgrades will choose the most recent version of
    the software available,</li>
<li><code>14-latest</code>, <code>13-latest</code>, <code>12-latest</code> - same as above, but preserves
    specific major Percona Distribution for PostgreSQL version for newly
    provisioned clusters (for example, 14 will not be automatically
    used instead of 13),</li>
<li><em>version number</em> - specify the desired version explicitly,</li>
<li><code>never</code> or <code>disabled</code> - disable automatic upgrades</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When automatic upgrades are disabled by the <code>apply</code> option,
Smart Update functionality will continue working for changes triggered
by other events, such as updating a ConfigMap, rotating a password, or
changing resource values.</p>
</div>
</li>
<li>
<p>Make sure the <code>versionServiceEndpoint</code> key is set to a valid Version
    Server URL (otherwise Smart Updates will not occur).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Perconas Version Service</label><label for="__tabbed_1_2">Version Service inside your cluster</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>You can use the URL of the official Perconas Version Service (default).
 Set <code>versionServiceEndpoint</code> to <code>https://check.percona.com</code>.</p>
</div>
<div class="tabbed-block">
<p>Alternatively, you can run Version Service inside your cluster. This
can be done with the <code>kubectl</code> command as follows:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>run<span class="w"> </span>version-service<span class="w"> </span>--image<span class="o">=</span>perconalab/version-service<span class="w"> </span>--env<span class="o">=</span><span class="s2">&quot;SERVE_HTTP=true&quot;</span><span class="w"> </span>--port<span class="w"> </span><span class="m">11000</span><span class="w"> </span>--expose
</code></pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Version Service is never checked if automatic updates are disabled.
If automatic updates are enabled, but Version Service URL can not be
reached, upgrades will not occur.</p>
</div>
</li>
<li>
<p>Use the <code>schedule</code> option to specify the update checks time in CRON format.</p>
<p>The following example sets the midnight update checks with the official
Perconas Version Service:</p>
<div class="highlight"><pre><span></span><code><span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upgradeOptions</span><span class="p">:</span>
<span class="w">    </span><span class="nt">apply</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">recommended</span>
<span class="w">    </span><span class="nt">versionServiceEndpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://check.percona.com</span>
<span class="w">    </span><span class="nt">schedule</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0</span><span class="nv"> </span><span class="s">4</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*&quot;</span>
<span class="nn">...</span>
</code></pre></div>
</li>
</ol>
<h3 id="semi-automatic-upgrade">Semi-automatic upgrade<a class="headerlink" href="#semi-automatic-upgrade" title="Permanent link">&para;</a></h3>
<p>The following command will allow you to update the Operator to current version
(use the name of your cluster instead of the <code>&lt;cluster-name&gt;</code> placeholder).</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>kubectl<span class="w"> </span>patch<span class="w"> </span>perconapgcluster/&lt;cluster-name&gt;<span class="w"> </span>--type<span class="w"> </span>json<span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/backup/backrestRepoImage&quot;, &quot;value&quot;: &quot;percona/percona-postgresql-operator:{{ release }}-ppg14-pgbackrest-repo&quot;},{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/backup/image&quot;,&quot;value&quot;:&quot;percona/percona-postgresql-operator:{{ release }}-ppg14-pgbackrest&quot;},{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/pgBadger/image&quot;,&quot;value&quot;:&quot;percona/percona-postgresql-operator:{{ release }}-ppg14-pgbadger&quot;},{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/pgBouncer/image&quot;,&quot;value&quot;:&quot;percona/percona-postgresql-operator:{{ release }}-ppg14-pgbouncer&quot;},{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/pgPrimary/image&quot;,&quot;value&quot;:&quot;percona/percona-postgresql-operator:{{ release }}-ppg14-postgres-ha&quot;},{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/userLabels/pgo-version&quot;,&quot;value&quot;:&quot;{{ release }}&quot;},{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/metadata/labels/pgo-version&quot;,&quot;value&quot;:&quot;{{ release }}&quot;}]&#39;</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above example is composed in assumption of using PostgreSQL 14 as
a database management system. For PostgreSQL 13 you should change all
occurrences of the <code>ppg14</code> substring to <code>ppg13</code>.</p>
</div>
<p>This will carry on the image and the cluster version update.</p>
<div data-banner="data-banner">
<h2 class="title" id="get-expert-help">Get expert help<a class="headerlink" href="#get-expert-help" title="Permanent link">&para;</a></h2>
<p>If you need assistance, visit the community forum for comprehensive and free database knowledge, or contact our Percona Database Experts for professional support and services. Join K8S Squad to benefit from early access to features and &ldquo;ask me anything&rdquo; sessions with the Experts. </p>
<div class="actions">
<p><a href="https://forums.percona.com/c/postgresql/percona-kubernetes-operator-for-postgresql/68?utm_campaign=Doc%20pages&amp;_gl=1*hqhs2g*_gcl_au*NDQzODI2NzEuMTY5MTQyMjA4OQ.."><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 4v7H5.17L4 12.17V4zm1-2H3a1 1 0 0 0-1 1v14l4-4h10a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1m5 4h-2v9H6v2a1 1 0 0 0 1 1h11l4 4V7a1 1 0 0 0-1-1"/></svg></span> Community Forum</a> <a href="https://www.percona.com/about/contact"><span class="twemoji"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path d="M19.3996 14.148C21.9082 12.5083 22.7289 9.16368 21.2109 6.53493C20.4502 5.21636 19.2207 4.27206 17.7497 3.87776C16.3868 3.51187 14.9634 3.6615 13.7106 4.29444L12 1.33337L8.44934 7.48295L0.242432 21.6959H23.7576L19.3996 14.148ZM17.3474 5.38416C18.4167 5.66894 19.3064 6.35548 19.8606 7.31143C20.9499 9.19582 20.384 11.5859 18.6176 12.7931L14.4917 5.64797C15.3806 5.22055 16.3831 5.12734 17.3474 5.38416ZM12 4.45432L21.0533 20.135H15.7562L9.35029 9.04341L11.9995 4.45478L12 4.45432ZM2.94667 20.135L8.44888 10.6071L13.9511 20.135H2.94667Z"/>
</svg></span> Get a Percona Expert</a></p>
</div>
</div>









  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thank you for your feedback! Help us improve by using our  <a href="https://docs.google.com/forms/d/1bkWACehjqlwA0AKf-qTJcXvYbOSYgze8iTPXjntqmNo/edit" target="_blank" rel="noopener"> feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <a href="https://www.percona.com/about">Percona LLC</a> and its affiliates &copy; 2024  <a href="#" onclick="Osano.cm.showDrawer('osano-cm-dom-info-dialog-open')">Cookie Preferences</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["search.highlight", "navigation.top", "navigation.tracking", "content.tabs.link", "content.action.edit", "content.action.view", "content.code.copy"], "search": "assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
              <script src="https://cmp.osano.com/Azqe5vTyLOSbN3OuT/49ad85b5-0418-4794-ab81-7599dddd534c/osano.js"></script>

              
      <script src="assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="js/promptremover.js"></script>
      
        <script src="js/consent.js"></script>
      
        <script src="js/toctree.js"></script>
      
        <script src="js/lightgallery.min.js"></script>
      
    

              <img src="https://tracking.g2crowd.com/attribution_tracking/conversions/1007137.gif?e=" width="1" height="1" />

              <noscript>
                <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WBVF48V" height="0" width="0" style="display:none;visibility:hidden"></iframe>
              </noscript>
              
  </body>
</html>